<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://cauliyang.github.io</id>
    <title>Vince&apos;s Core </title>
    <updated>2019-10-03T14:07:15.170Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://cauliyang.github.io"/>
    <link rel="self" href="https://cauliyang.github.io/atom.xml"/>
    <subtitle>记录并分享学习过程</subtitle>
    <logo>https://cauliyang.github.io/images/avatar.png</logo>
    <icon>https://cauliyang.github.io/favicon.ico</icon>
    <rights>All rights reserved 2019, Vince&apos;s Core </rights>
    <entry>
        <title type="html"><![CDATA[Bin map ]]></title>
        <id>https://cauliyang.github.io/post/xin-pian-shu-ju-gou-jian-yi-chuan-lian-suo-tu-biao-ji-shai-xuan-liu-cheng</id>
        <link href="https://cauliyang.github.io/post/xin-pian-shu-ju-gou-jian-yi-chuan-lian-suo-tu-biao-ji-shai-xuan-liu-cheng">
        </link>
        <updated>2019-09-09T01:06:33.000Z</updated>
        <summary type="html"><![CDATA[<p><strong>本文记录芯片数据如何筛选，以及使用bin map方法构建遗传图谱。</strong></p>
]]></summary>
        <content type="html"><![CDATA[<p><strong>本文记录芯片数据如何筛选，以及使用bin map方法构建遗传图谱。</strong></p>
<!-- more -->
<p>芯片数据的筛选大致分为以下步骤：</p>
<ol>
<li>
<p><strong>标记QC</strong></p>
<p>1.1	计算标记的检出率，保留&gt;80%，删除缺失率大于20%的标记<br>
<strong>可以适当调整阈值根据自己的数据量</strong></p>
<p>1.2	计算标记的杂合率（如果杂合率很高的情况下，这个SNP可能还是有问题的），但是杂合率的评判标准依据不同群体有所不同，如F2或BC1群体，标记杂合率普遍在40-60%之间，但RIL群体或DH群体就会低很多，可以针对自己的群体，设置合适的阈值</p>
<p>1.3	删除双亲为杂合且是缺失的标记</p>
<p>1.4	计算双亲的无多态性，删除双亲没有多态性的标记</p>
<p>1.5 计算标记的MAF，保留MAF&gt;0.05</p>
<p>1.6 群体内家系基因型根据两亲本更改为 A B H <strong>( 缺失不变）</strong></p>
<p>1.7 删除多拷贝SNP，注释信息中chr hit number&gt;1的标记，这个一般针对那些非常差的标记，<strong>可以忽略此步骤</strong></p>
</li>
<li>
<p><strong>样本QC</strong></p>
<p>2.1	确定标记后，用剩下的标记进行样本质控，计算每个材料的缺失率和杂合率，然后对材料进行筛选</p>
</li>
<li>
<p><strong>卡方测验</strong></p>
<p>3.1 进行卡方测验，计算标记的分离比，删除严重偏分离的标记，这一步也可以在JoinMap，rqtl,AsMap中操作。</p>
</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[博客想法]]></title>
        <id>https://cauliyang.github.io/post/bo-ke-xiang-fa</id>
        <link href="https://cauliyang.github.io/post/bo-ke-xiang-fa">
        </link>
        <updated>2019-09-09T00:46:16.000Z</updated>
        <summary type="html"><![CDATA[<p>博客记录学习过程，欢迎大家一起交流！😊</p>
]]></summary>
        <content type="html"><![CDATA[<p>博客记录学习过程，欢迎大家一起交流！😊</p>
<!-- more -->
<p>本博客用来当作公开的个人笔记，记录自己的学习过程。希望能够帮助到他人～。<br>
如果有侵权问题，可以联系我。我会立即删除。</p>
<figure data-type="image" tabindex="1"><img src="https://cauliyang.github.io/post-images/1567990179919" alt=""></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Vcftools  使用概述]]></title>
        <id>https://cauliyang.github.io/post/vcftools-1</id>
        <link href="https://cauliyang.github.io/post/vcftools-1">
        </link>
        <updated>2019-08-20T04:54:06.000Z</updated>
        <summary type="html"><![CDATA[<p>整理并记录处理VCf文件格式的工具<strong>vcftools</strong>的使用方法，主要用于自己使用。<strong>（侵权，立即删。😊）</strong></p>
]]></summary>
        <content type="html"><![CDATA[<p>整理并记录处理VCf文件格式的工具<strong>vcftools</strong>的使用方法，主要用于自己使用。<strong>（侵权，立即删。😊）</strong></p>
<!-- more -->
<h2 id="1-文件的读入和输出">1. 文件的读入和输出</h2>
<table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>--vcf</td>
<td style="text-align:left">读入vcf类型文件，如不输入其他参数则统计位点，个体信息</td>
</tr>
<tr>
<td>--gzvcf</td>
<td style="text-align:left">读入vcf.gz类型文件，如不输入其他参数则统计位点，个体信息</td>
</tr>
<tr>
<td>--bcf</td>
<td style="text-align:left">读入bcf类型文件，如不输入其他参数则统计位点，个体信息</td>
</tr>
<tr>
<td>--out</td>
<td style="text-align:left">输出文件，需要添加 --recode 参数(重构vcf结果输出INFO列信息）</td>
</tr>
<tr>
<td>--stdout</td>
<td style="text-align:left">输出到标准输出，可配合bgzip，gzip进行压缩</td>
</tr>
<tr>
<td>--recode</td>
<td style="text-align:left">一般与--out一起使用，加入--recode-INFO-all则保留原文件INFO</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>For instance:</strong></p>
<ul>
<li>提取一号染色体上的变异信息到filename文件</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --chr 1 --recode --out filename</code></strong></p>
<ul>
<li>将一号染色体上的变异信息输出到屏幕</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --chr 1 --recode --stdout</code></strong></p>
<ul>
<li>统计个体个数和突变位点总数</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf</code></strong></p>
<ul>
<li>提取染色体A01上的SNP，输出到A01.vcf。<strong>需要带--recode参数</strong></li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --chr A01 --from-bp 1000000 --to-bp 2000000 --recode --recode-INFO-all --out A01.vcf</code></strong></p>
<h2 id="2vcftools-对snp数据过滤">2.vcftools 对snp数据过滤</h2>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>--chr，--not-chr</td>
<td>保留或者去掉某条染色体</td>
</tr>
<tr>
<td>--keep-only-indels，--remove-indels</td>
<td>保留indels，或者去掉indels保留snps</td>
</tr>
<tr>
<td>--indv，--remove-indv</td>
<td>保留或者去掉<strong>某种样品</strong></td>
</tr>
<tr>
<td>--keep，--remove</td>
<td>保留或者去掉<strong>某些样品</strong></td>
</tr>
<tr>
<td>--max-maf</td>
<td>最大等位基因频率</td>
</tr>
<tr>
<td>--maf</td>
<td>最小等位基因频率</td>
</tr>
<tr>
<td>--max-missing</td>
<td><strong>完整度(0-1之间）= 1 - 缺失度</strong></td>
</tr>
<tr>
<td>--minDP</td>
<td>最小深度</td>
</tr>
<tr>
<td>--snps ，--exclude</td>
<td>根据SNP位点过滤</td>
</tr>
<tr>
<td>--min-alleles</td>
<td>最小等位基因数量</td>
</tr>
<tr>
<td>--max-alleles</td>
<td>最大等位基因数量</td>
</tr>
<tr>
<td>--remove-filtered-all</td>
<td>删除FILTER列不是PASS</td>
</tr>
<tr>
<td>--SNPdensity</td>
<td>计算snp在bin内的密度，其后接bin大小</td>
</tr>
<tr>
<td>--extract-FORMAT-info</td>
<td>提取你想要的info，e.g. GT</td>
</tr>
<tr>
<td>--get-INFO</td>
<td>多次提取info，e.g. --get-INFO NS --get-INFO DB</td>
</tr>
</tbody>
</table>
<p>-------------------;</p>
<p><strong>For instance:</strong></p>
<ul>
<li>深度设置为2，每个SNP位点完整度设置为0.7，最小等位基因频率设置为0.05</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --minDP 2 --maf 0.05 --max-missing 0.7 --recode --out o utfile</code></strong></p>
<ul>
<li>从所有样品中提取S1和S2</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --indv S1 --indv S2 --recode --out outfile</code></strong></p>
<ul>
<li>从所有样品中批量提取样品</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --keep sample.list --recode --out outfile</code></strong></p>
<ul>
<li>提取两个等位基因的SNP位点</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --min-alleles 2 --max-alleles 2 --recode --out outfile</code></strong></p>
<h2 id="3vcftools-在群体遗传学中的应用">3.Vcftools 在群体遗传学中的应用</h2>
<blockquote>
<p>计算遗传多样性参数 ： <strong>Fst，π，Tajima'sD</strong> 等</p>
</blockquote>
<h3 id="31-fst计算">3.1 Fst计算</h3>
<pre><code> Fst是衡量群体间分化程度的重要参数，Fst越大，表明群体分化程度越高，受选择程度越高。基于Fst可以进行选择性消除分析。
</code></pre>
<p><strong>For instance:</strong></p>
<ul>
<li>
<p>计算两个群体间fst值，S1.txt和S2.txt是包含了各群体的样品名</p>
<p><strong><code>vcftools --vcf all.vcf --weir-fst-pop S1.txt --weir-fst-pop S2.txt ---fst-window-size 200000 --fst-window-step 100000 --out outfile</code></strong></p>
</li>
</ul>
<h3 id="32-核苷酸多态性统计">3.2 核苷酸多态性统计</h3>
<pre><code>核苷酸多样性π反映了群体的多态性。一般来说受选择程度越高的群体，遗传多样性越单一；野生群体遗传多样性较高。基于π可以进行选择性消除分析。
</code></pre>
<p><strong>For instance:</strong></p>
<ul>
<li>计算群体核苷酸多态性</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --window-pi 1000 --window-pi-step 1000 --out filename</code></strong></p>
<ul>
<li>计算所有单点或所选多点(--positions)的核苷酸多态性</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --site-pi (--positions SNP_list.txt) --out filename</code></strong></p>
<h3 id="33-tajimas-d计算">3.3 Tajima's D计算</h3>
<pre><code>Tajima's D衡量群体中性进化理论的指标，越偏离0，受选择程度越高。
</code></pre>
<p><strong>For instance:</strong></p>
<ul>
<li>计算Tajima's D</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --TajimaD 100000 --out filename</code></strong></p>
<h3 id="34-ld等其他统计参数">3.4 LD等其他统计参数</h3>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>--hap-r2，--geno-r2</td>
<td>LD统计</td>
</tr>
<tr>
<td>--TsTV</td>
<td>SNP转换/颠换统计</td>
</tr>
<tr>
<td>--freq</td>
<td>每个SNP等位基因频率统计</td>
</tr>
<tr>
<td>--counts</td>
<td>每个SNP等位基因个数统计</td>
</tr>
<tr>
<td>--SNPdensity</td>
<td>SNP频率</td>
</tr>
<tr>
<td>--missing-indv</td>
<td>样品等缺失率统计</td>
</tr>
<tr>
<td>--missing-site</td>
<td>SNP缺失率统计</td>
</tr>
<tr>
<td>--depth</td>
<td>个体深度统计</td>
</tr>
<tr>
<td>--site-depth，--site-mean-depth</td>
<td>位点深度，平均深度统计</td>
</tr>
</tbody>
</table>
<h2 id="4其他">4.其他</h2>
<h3 id="41-比较两个vcf文件">4.1 比较两个vcf文件</h3>
<ul>
<li>
<p>比较2个群体的vcf文件，包含多个选项，常用的如<br>
–diff-site<br>
–diff-indv</p>
<p><strong><code>vcftools --gzvcf input_file1.vcf.gz --gzdiff input_file2.vcf.gz --diff-site --out in1_v_in2</code></strong></p>
</li>
</ul>
<h3 id="42-vcf转化plink">4.2 VCF转化plink</h3>
<ul>
<li>vcftools还可以转化多种格式，常用的是转化成plink格式。</li>
</ul>
<p>参数：--012，--IMPUTE，--ldhat-geno，--BEAGLE-GL，--BEAGLE-PL，--plink</p>
<p><strong><code>vcftools --vcf infile.vcf --plink --chr 1 --out output_in_plink</code></strong></p>
<ul>
<li>合并多个vcf文件(也可以使用GATK）</li>
</ul>
<p><strong><code>bcftools merge A.vcf B.vcf &gt; AB.vcf</code></strong></p>
<h3 id="43-其他格式转换">4.3 其他格式转换</h3>
<ul>
<li>--012</li>
<li>--IMPUTE</li>
<li>--ldhat</li>
<li>--ldhat-geno</li>
<li>--BEAGLE-GL</li>
<li>--BEAGLE-PL<br>
---;</li>
</ul>
<p>具体使用方法可以看 <a href="https://vcftools.github.io/man_latest.html"><strong>vcftools说明</strong></a></p>
<h2 id="5总结">5.总结</h2>
<p>本文旨在学习和整理用到的大部分vcftools方法，如果有所纰漏欢迎指正！😊</p>
]]></content>
    </entry>
</feed>