<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://cauliyang.github.io</id>
    <title>Vince&apos;s Core </title>
    <updated>2019-10-27T08:46:02.494Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://cauliyang.github.io"/>
    <link rel="self" href="https://cauliyang.github.io/atom.xml"/>
    <subtitle>Cherish time, just like cherishing your eyes.</subtitle>
    <logo>https://cauliyang.github.io/images/avatar.png</logo>
    <icon>https://cauliyang.github.io/favicon.ico</icon>
    <rights>All rights reserved 2019, Vince&apos;s Core </rights>
    <entry>
        <title type="html"><![CDATA[PCA by Python ]]></title>
        <id>https://cauliyang.github.io/post/pca-by-python</id>
        <link href="https://cauliyang.github.io/post/pca-by-python">
        </link>
        <updated>2019-10-03T14:07:56.000Z</updated>
        <summary type="html"><![CDATA[<p><strong>æœ¬ç¯‡æ–‡ç« è®°å½•ä½¿ç”¨Pythonè¿›è¡ŒPCAåˆ†æçš„ä¸¤ç§æ–¹æ³•ï¼ŒåŠå¯è§†åŒ–2ç»´ç»“æœ</strong></p>
]]></summary>
        <content type="html"><![CDATA[<p><strong>æœ¬ç¯‡æ–‡ç« è®°å½•ä½¿ç”¨Pythonè¿›è¡ŒPCAåˆ†æçš„ä¸¤ç§æ–¹æ³•ï¼ŒåŠå¯è§†åŒ–2ç»´ç»“æœ</strong></p>
<!-- more -->
<p>å…ˆå¼€å‘ï¼ŒåŠ±å¿—å¡«å‘</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Bin map ]]></title>
        <id>https://cauliyang.github.io/post/xin-pian-shu-ju-gou-jian-yi-chuan-lian-suo-tu-biao-ji-shai-xuan-liu-cheng</id>
        <link href="https://cauliyang.github.io/post/xin-pian-shu-ju-gou-jian-yi-chuan-lian-suo-tu-biao-ji-shai-xuan-liu-cheng">
        </link>
        <updated>2019-09-09T01:06:33.000Z</updated>
        <summary type="html"><![CDATA[<p><strong>æœ¬æ–‡è®°å½•èŠ¯ç‰‡æ•°æ®å¦‚ä½•ç­›é€‰ï¼Œä»¥åŠä½¿ç”¨bin mapæ–¹æ³•æ„å»ºé—ä¼ å›¾è°±ã€‚</strong></p>
]]></summary>
        <content type="html"><![CDATA[<p><strong>æœ¬æ–‡è®°å½•èŠ¯ç‰‡æ•°æ®å¦‚ä½•ç­›é€‰ï¼Œä»¥åŠä½¿ç”¨bin mapæ–¹æ³•æ„å»ºé—ä¼ å›¾è°±ã€‚</strong></p>
<!-- more -->
<p>èŠ¯ç‰‡æ•°æ®çš„ç­›é€‰å¤§è‡´åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>
<p><strong>æ ‡è®°QC</strong></p>
<p>1.1	è®¡ç®—æ ‡è®°çš„æ£€å‡ºç‡ï¼Œä¿ç•™&gt;80%ï¼Œåˆ é™¤ç¼ºå¤±ç‡å¤§äº20%çš„æ ‡è®°<br>
<strong>å¯ä»¥é€‚å½“è°ƒæ•´é˜ˆå€¼æ ¹æ®è‡ªå·±çš„æ•°æ®é‡</strong></p>
<p>1.2	è®¡ç®—æ ‡è®°çš„æ‚åˆç‡ï¼ˆå¦‚æœæ‚åˆç‡å¾ˆé«˜çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªSNPå¯èƒ½è¿˜æ˜¯æœ‰é—®é¢˜çš„ï¼‰ï¼Œä½†æ˜¯æ‚åˆç‡çš„è¯„åˆ¤æ ‡å‡†ä¾æ®ä¸åŒç¾¤ä½“æœ‰æ‰€ä¸åŒï¼Œå¦‚F2æˆ–BC1ç¾¤ä½“ï¼Œæ ‡è®°æ‚åˆç‡æ™®éåœ¨40-60%ä¹‹é—´ï¼Œä½†RILç¾¤ä½“æˆ–DHç¾¤ä½“å°±ä¼šä½å¾ˆå¤šï¼Œå¯ä»¥é’ˆå¯¹è‡ªå·±çš„ç¾¤ä½“ï¼Œè®¾ç½®åˆé€‚çš„é˜ˆå€¼</p>
<p>1.3	åˆ é™¤åŒäº²ä¸ºæ‚åˆä¸”æ˜¯ç¼ºå¤±çš„æ ‡è®°</p>
<p>1.4	è®¡ç®—åŒäº²çš„æ— å¤šæ€æ€§ï¼Œåˆ é™¤åŒäº²æ²¡æœ‰å¤šæ€æ€§çš„æ ‡è®°</p>
<p>1.5 è®¡ç®—æ ‡è®°çš„MAFï¼Œä¿ç•™MAF&gt;0.05</p>
<p>1.6 ç¾¤ä½“å†…å®¶ç³»åŸºå› å‹æ ¹æ®ä¸¤äº²æœ¬æ›´æ”¹ä¸º A B H <strong>( ç¼ºå¤±ä¸å˜ï¼‰</strong></p>
<p>1.7 åˆ é™¤å¤šæ‹·è´SNPï¼Œæ³¨é‡Šä¿¡æ¯ä¸­chr hit number&gt;1çš„æ ‡è®°ï¼Œè¿™ä¸ªä¸€èˆ¬é’ˆå¯¹é‚£äº›éå¸¸å·®çš„æ ‡è®°ï¼Œ<strong>å¯ä»¥å¿½ç•¥æ­¤æ­¥éª¤</strong></p>
</li>
<li>
<p><strong>æ ·æœ¬QC</strong></p>
<p>2.1	ç¡®å®šæ ‡è®°åï¼Œç”¨å‰©ä¸‹çš„æ ‡è®°è¿›è¡Œæ ·æœ¬è´¨æ§ï¼Œè®¡ç®—æ¯ä¸ªææ–™çš„ç¼ºå¤±ç‡å’Œæ‚åˆç‡ï¼Œç„¶åå¯¹ææ–™è¿›è¡Œç­›é€‰</p>
</li>
<li>
<p><strong>å¡æ–¹æµ‹éªŒ</strong></p>
<p>3.1 è¿›è¡Œå¡æ–¹æµ‹éªŒï¼Œè®¡ç®—æ ‡è®°çš„åˆ†ç¦»æ¯”ï¼Œåˆ é™¤ä¸¥é‡ååˆ†ç¦»çš„æ ‡è®°ï¼Œè¿™ä¸€æ­¥ä¹Ÿå¯ä»¥åœ¨JoinMapï¼Œrqtl,AsMapä¸­æ“ä½œã€‚</p>
</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Blog Ideas ]]></title>
        <id>https://cauliyang.github.io/post/bo-ke-xiang-fa</id>
        <link href="https://cauliyang.github.io/post/bo-ke-xiang-fa">
        </link>
        <updated>2019-09-09T00:46:16.000Z</updated>
        <summary type="html"><![CDATA[<p>This Blog record learning process, welcome everyone to communicate!ğŸ˜Š</p>
]]></summary>
        <content type="html"><![CDATA[<p>This Blog record learning process, welcome everyone to communicate!ğŸ˜Š</p>
<!-- more -->
<h1 id="ideas">Ideas</h1>
<p>This blog is used as a public note to record my learning process. I also hope to help others~.</p>
<p>If you have an infringement problem, then you can contact me. if it is true ,I will delete it immediately.</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Vcftools  ä½¿ç”¨æ¦‚è¿°]]></title>
        <id>https://cauliyang.github.io/post/vcftools-1</id>
        <link href="https://cauliyang.github.io/post/vcftools-1">
        </link>
        <updated>2019-08-20T04:54:06.000Z</updated>
        <summary type="html"><![CDATA[<p>æ•´ç†å¹¶è®°å½•å¤„ç†VCfæ–‡ä»¶æ ¼å¼çš„å·¥å…·<strong>vcftools</strong>çš„ä½¿ç”¨æ–¹æ³•ï¼Œä¸»è¦ç”¨äºè‡ªå·±ä½¿ç”¨ã€‚<strong>ï¼ˆä¾µæƒï¼Œç«‹å³åˆ ã€‚ğŸ˜Šï¼‰</strong></p>
]]></summary>
        <content type="html"><![CDATA[<p>æ•´ç†å¹¶è®°å½•å¤„ç†VCfæ–‡ä»¶æ ¼å¼çš„å·¥å…·<strong>vcftools</strong>çš„ä½¿ç”¨æ–¹æ³•ï¼Œä¸»è¦ç”¨äºè‡ªå·±ä½¿ç”¨ã€‚<strong>ï¼ˆä¾µæƒï¼Œç«‹å³åˆ ã€‚ğŸ˜Šï¼‰</strong></p>
<!-- more -->
<h2 id="1-æ–‡ä»¶çš„è¯»å…¥å’Œè¾“å‡º">1. æ–‡ä»¶çš„è¯»å…¥å’Œè¾“å‡º</h2>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th style="text-align:left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>--vcf</td>
<td style="text-align:left">è¯»å…¥vcfç±»å‹æ–‡ä»¶ï¼Œå¦‚ä¸è¾“å…¥å…¶ä»–å‚æ•°åˆ™ç»Ÿè®¡ä½ç‚¹ï¼Œä¸ªä½“ä¿¡æ¯</td>
</tr>
<tr>
<td>--gzvcf</td>
<td style="text-align:left">è¯»å…¥vcf.gzç±»å‹æ–‡ä»¶ï¼Œå¦‚ä¸è¾“å…¥å…¶ä»–å‚æ•°åˆ™ç»Ÿè®¡ä½ç‚¹ï¼Œä¸ªä½“ä¿¡æ¯</td>
</tr>
<tr>
<td>--bcf</td>
<td style="text-align:left">è¯»å…¥bcfç±»å‹æ–‡ä»¶ï¼Œå¦‚ä¸è¾“å…¥å…¶ä»–å‚æ•°åˆ™ç»Ÿè®¡ä½ç‚¹ï¼Œä¸ªä½“ä¿¡æ¯</td>
</tr>
<tr>
<td>--out</td>
<td style="text-align:left">è¾“å‡ºæ–‡ä»¶ï¼Œéœ€è¦æ·»åŠ  --recode å‚æ•°(é‡æ„vcfç»“æœè¾“å‡ºINFOåˆ—ä¿¡æ¯ï¼‰</td>
</tr>
<tr>
<td>--stdout</td>
<td style="text-align:left">è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œå¯é…åˆbgzipï¼Œgzipè¿›è¡Œå‹ç¼©</td>
</tr>
<tr>
<td>--recode</td>
<td style="text-align:left">ä¸€èˆ¬ä¸--outä¸€èµ·ä½¿ç”¨ï¼ŒåŠ å…¥--recode-INFO-allåˆ™ä¿ç•™åŸæ–‡ä»¶INFO</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>For instance:</strong></p>
<ul>
<li>æå–ä¸€å·æŸ“è‰²ä½“ä¸Šçš„å˜å¼‚ä¿¡æ¯åˆ°filenameæ–‡ä»¶</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --chr 1 --recode --out filename</code></strong></p>
<ul>
<li>å°†ä¸€å·æŸ“è‰²ä½“ä¸Šçš„å˜å¼‚ä¿¡æ¯è¾“å‡ºåˆ°å±å¹•</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --chr 1 --recode --stdout</code></strong></p>
<ul>
<li>ç»Ÿè®¡ä¸ªä½“ä¸ªæ•°å’Œçªå˜ä½ç‚¹æ€»æ•°</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf</code></strong></p>
<ul>
<li>æå–æŸ“è‰²ä½“A01ä¸Šçš„SNPï¼Œè¾“å‡ºåˆ°A01.vcfã€‚<strong>éœ€è¦å¸¦--recodeå‚æ•°</strong></li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --chr A01 --from-bp 1000000 --to-bp 2000000 --recode --recode-INFO-all --out A01.vcf</code></strong></p>
<h2 id="2vcftools-å¯¹snpæ•°æ®è¿‡æ»¤">2.vcftools å¯¹snpæ•°æ®è¿‡æ»¤</h2>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>--chrï¼Œ--not-chr</td>
<td>ä¿ç•™æˆ–è€…å»æ‰æŸæ¡æŸ“è‰²ä½“</td>
</tr>
<tr>
<td>--keep-only-indelsï¼Œ--remove-indels</td>
<td>ä¿ç•™indelsï¼Œæˆ–è€…å»æ‰indelsä¿ç•™snps</td>
</tr>
<tr>
<td>--indvï¼Œ--remove-indv</td>
<td>ä¿ç•™æˆ–è€…å»æ‰<strong>æŸç§æ ·å“</strong></td>
</tr>
<tr>
<td>--keepï¼Œ--remove</td>
<td>ä¿ç•™æˆ–è€…å»æ‰<strong>æŸäº›æ ·å“</strong></td>
</tr>
<tr>
<td>--max-maf</td>
<td>æœ€å¤§ç­‰ä½åŸºå› é¢‘ç‡</td>
</tr>
<tr>
<td>--maf</td>
<td>æœ€å°ç­‰ä½åŸºå› é¢‘ç‡</td>
</tr>
<tr>
<td>--max-missing</td>
<td><strong>å®Œæ•´åº¦(0-1ä¹‹é—´ï¼‰= 1 - ç¼ºå¤±åº¦</strong></td>
</tr>
<tr>
<td>--minDP</td>
<td>æœ€å°æ·±åº¦</td>
</tr>
<tr>
<td>--snps ï¼Œ--exclude</td>
<td>æ ¹æ®SNPä½ç‚¹è¿‡æ»¤</td>
</tr>
<tr>
<td>--min-alleles</td>
<td>æœ€å°ç­‰ä½åŸºå› æ•°é‡</td>
</tr>
<tr>
<td>--max-alleles</td>
<td>æœ€å¤§ç­‰ä½åŸºå› æ•°é‡</td>
</tr>
<tr>
<td>--remove-filtered-all</td>
<td>åˆ é™¤FILTERåˆ—ä¸æ˜¯PASS</td>
</tr>
<tr>
<td>--SNPdensity</td>
<td>è®¡ç®—snpåœ¨binå†…çš„å¯†åº¦ï¼Œå…¶åæ¥binå¤§å°</td>
</tr>
<tr>
<td>--extract-FORMAT-info</td>
<td>æå–ä½ æƒ³è¦çš„infoï¼Œe.g. GT</td>
</tr>
<tr>
<td>--get-INFO</td>
<td>å¤šæ¬¡æå–infoï¼Œe.g. --get-INFO NS --get-INFO DB</td>
</tr>
</tbody>
</table>
<p>-------------------;</p>
<p><strong>For instance:</strong></p>
<ul>
<li>æ·±åº¦è®¾ç½®ä¸º2ï¼Œæ¯ä¸ªSNPä½ç‚¹å®Œæ•´åº¦è®¾ç½®ä¸º0.7ï¼Œæœ€å°ç­‰ä½åŸºå› é¢‘ç‡è®¾ç½®ä¸º0.05</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --minDP 2 --maf 0.05 --max-missing 0.7 --recode --out o utfile</code></strong></p>
<ul>
<li>ä»æ‰€æœ‰æ ·å“ä¸­æå–S1å’ŒS2</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --indv S1 --indv S2 --recode --out outfile</code></strong></p>
<ul>
<li>ä»æ‰€æœ‰æ ·å“ä¸­æ‰¹é‡æå–æ ·å“</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --keep sample.list --recode --out outfile</code></strong></p>
<ul>
<li>æå–ä¸¤ä¸ªç­‰ä½åŸºå› çš„SNPä½ç‚¹</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --min-alleles 2 --max-alleles 2 --recode --out outfile</code></strong></p>
<h2 id="3vcftools-åœ¨ç¾¤ä½“é—ä¼ å­¦ä¸­çš„åº”ç”¨">3.Vcftools åœ¨ç¾¤ä½“é—ä¼ å­¦ä¸­çš„åº”ç”¨</h2>
<blockquote>
<p>è®¡ç®—é—ä¼ å¤šæ ·æ€§å‚æ•° ï¼š <strong>Fstï¼ŒÏ€ï¼ŒTajima'sD</strong> ç­‰</p>
</blockquote>
<h3 id="31-fstè®¡ç®—">3.1 Fstè®¡ç®—</h3>
<pre><code> Fstæ˜¯è¡¡é‡ç¾¤ä½“é—´åˆ†åŒ–ç¨‹åº¦çš„é‡è¦å‚æ•°ï¼ŒFstè¶Šå¤§ï¼Œè¡¨æ˜ç¾¤ä½“åˆ†åŒ–ç¨‹åº¦è¶Šé«˜ï¼Œå—é€‰æ‹©ç¨‹åº¦è¶Šé«˜ã€‚åŸºäºFstå¯ä»¥è¿›è¡Œé€‰æ‹©æ€§æ¶ˆé™¤åˆ†æã€‚
</code></pre>
<p><strong>For instance:</strong></p>
<ul>
<li>
<p>è®¡ç®—ä¸¤ä¸ªç¾¤ä½“é—´fstå€¼ï¼ŒS1.txtå’ŒS2.txtæ˜¯åŒ…å«äº†å„ç¾¤ä½“çš„æ ·å“å</p>
<p><strong><code>vcftools --vcf all.vcf --weir-fst-pop S1.txt --weir-fst-pop S2.txt ---fst-window-size 200000 --fst-window-step 100000 --out outfile</code></strong></p>
</li>
</ul>
<h3 id="32-æ ¸è‹·é…¸å¤šæ€æ€§ç»Ÿè®¡">3.2 æ ¸è‹·é…¸å¤šæ€æ€§ç»Ÿè®¡</h3>
<pre><code>æ ¸è‹·é…¸å¤šæ ·æ€§Ï€åæ˜ äº†ç¾¤ä½“çš„å¤šæ€æ€§ã€‚ä¸€èˆ¬æ¥è¯´å—é€‰æ‹©ç¨‹åº¦è¶Šé«˜çš„ç¾¤ä½“ï¼Œé—ä¼ å¤šæ ·æ€§è¶Šå•ä¸€ï¼›é‡ç”Ÿç¾¤ä½“é—ä¼ å¤šæ ·æ€§è¾ƒé«˜ã€‚åŸºäºÏ€å¯ä»¥è¿›è¡Œé€‰æ‹©æ€§æ¶ˆé™¤åˆ†æã€‚
</code></pre>
<p><strong>For instance:</strong></p>
<ul>
<li>è®¡ç®—ç¾¤ä½“æ ¸è‹·é…¸å¤šæ€æ€§</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --window-pi 1000 --window-pi-step 1000 --out filename</code></strong></p>
<ul>
<li>è®¡ç®—æ‰€æœ‰å•ç‚¹æˆ–æ‰€é€‰å¤šç‚¹(--positions)çš„æ ¸è‹·é…¸å¤šæ€æ€§</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --site-pi (--positions SNP_list.txt) --out filename</code></strong></p>
<h3 id="33-tajimas-dè®¡ç®—">3.3 Tajima's Dè®¡ç®—</h3>
<pre><code>Tajima's Dè¡¡é‡ç¾¤ä½“ä¸­æ€§è¿›åŒ–ç†è®ºçš„æŒ‡æ ‡ï¼Œè¶Šåç¦»0ï¼Œå—é€‰æ‹©ç¨‹åº¦è¶Šé«˜ã€‚
</code></pre>
<p><strong>For instance:</strong></p>
<ul>
<li>è®¡ç®—Tajima's D</li>
</ul>
<p><strong><code>vcftools --vcf infile.vcf --TajimaD 100000 --out filename</code></strong></p>
<h3 id="34-ldç­‰å…¶ä»–ç»Ÿè®¡å‚æ•°">3.4 LDç­‰å…¶ä»–ç»Ÿè®¡å‚æ•°</h3>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>--hap-r2ï¼Œ--geno-r2</td>
<td>LDç»Ÿè®¡</td>
</tr>
<tr>
<td>--TsTV</td>
<td>SNPè½¬æ¢/é¢ æ¢ç»Ÿè®¡</td>
</tr>
<tr>
<td>--freq</td>
<td>æ¯ä¸ªSNPç­‰ä½åŸºå› é¢‘ç‡ç»Ÿè®¡</td>
</tr>
<tr>
<td>--counts</td>
<td>æ¯ä¸ªSNPç­‰ä½åŸºå› ä¸ªæ•°ç»Ÿè®¡</td>
</tr>
<tr>
<td>--SNPdensity</td>
<td>SNPé¢‘ç‡</td>
</tr>
<tr>
<td>--missing-indv</td>
<td>æ ·å“ç­‰ç¼ºå¤±ç‡ç»Ÿè®¡</td>
</tr>
<tr>
<td>--missing-site</td>
<td>SNPç¼ºå¤±ç‡ç»Ÿè®¡</td>
</tr>
<tr>
<td>--depth</td>
<td>ä¸ªä½“æ·±åº¦ç»Ÿè®¡</td>
</tr>
<tr>
<td>--site-depthï¼Œ--site-mean-depth</td>
<td>ä½ç‚¹æ·±åº¦ï¼Œå¹³å‡æ·±åº¦ç»Ÿè®¡</td>
</tr>
</tbody>
</table>
<h2 id="4å…¶ä»–">4.å…¶ä»–</h2>
<h3 id="41-æ¯”è¾ƒä¸¤ä¸ªvcfæ–‡ä»¶">4.1 æ¯”è¾ƒä¸¤ä¸ªvcfæ–‡ä»¶</h3>
<ul>
<li>
<p>æ¯”è¾ƒ2ä¸ªç¾¤ä½“çš„vcfæ–‡ä»¶ï¼ŒåŒ…å«å¤šä¸ªé€‰é¡¹ï¼Œå¸¸ç”¨çš„å¦‚<br>
â€“diff-site<br>
â€“diff-indv</p>
<p><strong><code>vcftools --gzvcf input_file1.vcf.gz --gzdiff input_file2.vcf.gz --diff-site --out in1_v_in2</code></strong></p>
</li>
</ul>
<h3 id="42-vcfè½¬åŒ–plink">4.2 VCFè½¬åŒ–plink</h3>
<ul>
<li>vcftoolsè¿˜å¯ä»¥è½¬åŒ–å¤šç§æ ¼å¼ï¼Œå¸¸ç”¨çš„æ˜¯è½¬åŒ–æˆplinkæ ¼å¼ã€‚</li>
</ul>
<p>å‚æ•°ï¼š--012ï¼Œ--IMPUTEï¼Œ--ldhat-genoï¼Œ--BEAGLE-GLï¼Œ--BEAGLE-PLï¼Œ--plink</p>
<p><strong><code>vcftools --vcf infile.vcf --plink --chr 1 --out output_in_plink</code></strong></p>
<ul>
<li>åˆå¹¶å¤šä¸ªvcfæ–‡ä»¶(ä¹Ÿå¯ä»¥ä½¿ç”¨GATKï¼‰</li>
</ul>
<p><strong><code>bcftools merge A.vcf B.vcf &gt; AB.vcf</code></strong></p>
<h3 id="43-å…¶ä»–æ ¼å¼è½¬æ¢">4.3 å…¶ä»–æ ¼å¼è½¬æ¢</h3>
<ul>
<li>--012</li>
<li>--IMPUTE</li>
<li>--ldhat</li>
<li>--ldhat-geno</li>
<li>--BEAGLE-GL</li>
<li>--BEAGLE-PL<br>
---;</li>
</ul>
<p>å…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥çœ‹ <a href="https://vcftools.github.io/man_latest.html"><strong>vcftoolsè¯´æ˜</strong></a></p>
<h2 id="5æ€»ç»“">5.æ€»ç»“</h2>
<p>æœ¬æ–‡æ—¨åœ¨å­¦ä¹ å’Œæ•´ç†ç”¨åˆ°çš„å¤§éƒ¨åˆ†vcftoolsæ–¹æ³•ï¼Œå¦‚æœæœ‰æ‰€çº°æ¼æ¬¢è¿æŒ‡æ­£ï¼ğŸ˜Š</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[K-means  by Python]]></title>
        <id>https://cauliyang.github.io/post/k-means-cluster-by-python</id>
        <link href="https://cauliyang.github.io/post/k-means-cluster-by-python">
        </link>
        <updated>2019-08-07T14:09:35.000Z</updated>
        <summary type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ï¼Œè¯¦ç»†è®°å½•å¦‚ä½•ä½¿ç”¨<strong>Python</strong>è¿›è¡Œ<strong>K-means</strong>ï¼Œåˆ†åˆ«ç”¨ä¸¤ç§æ–¹æ³•å®ç°ï¼Œå¹¶è®°å½•å¦‚ä½•é€‰å–Kå€¼ï¼Œå¹¶è¿›è¡Œå¯è§†åŒ–è¯„ä¼°ç»“æœã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ï¼Œè¯¦ç»†è®°å½•å¦‚ä½•ä½¿ç”¨<strong>Python</strong>è¿›è¡Œ<strong>K-means</strong>ï¼Œåˆ†åˆ«ç”¨ä¸¤ç§æ–¹æ³•å®ç°ï¼Œå¹¶è®°å½•å¦‚ä½•é€‰å–Kå€¼ï¼Œå¹¶è¿›è¡Œå¯è§†åŒ–è¯„ä¼°ç»“æœã€‚</p>
<!-- more --> 
<style>
img{
    width: 80%;
    padding-left: 10%;
}
</style>
<h2 id="1k-meansæ¦‚å¿µä»‹ç»">1.<strong>K-means</strong>æ¦‚å¿µä»‹ç»</h2>
<hr>
<h3 id="11-åŸºç¡€æ¦‚å¿µ">1.1 åŸºç¡€æ¦‚å¿µ</h3>
<p><strong>K-means</strong>æ˜¯ä¸€ç§å¸¸ç”¨çš„æ— ç›‘ç£å­¦ä¹ æŠ€æœ¯ï¼Œç”¨äºåœ¨æ— æ³•çŸ¥é“æ­£ç¡®ç­”æ¡ˆä¸‹å‘ç°æ•°æ®ä¸­éšè—çš„ç»“æ„ï¼Œèšç±»çš„ç›®æ ‡æ˜¯åœ¨æ•°æ®ä¸­æ‰¾åˆ°è‡ªç„¶åˆ†ç»„ï¼Œç¡®ä¿ç›¸åŒé›†ç¾¤ä¸­å…ƒç´ æ¯”ä¸åŒçš„é›†ç¾¤ä¸­å…ƒç´ æ›´åŠ ç›¸ä¼¼ã€‚<strong>K-means</strong>æ–¹æ³•éå¸¸æ“…é•¿è¯†åˆ«çƒå½¢æ•°æ®ï¼Œå…¶ç¼ºç‚¹æ˜¯å¿…é¡»æŒ‡å®šé›†ç¾¤æ•°<strong>K</strong>ã€‚å¦‚æœé€‰æ‹©<strong>K</strong>å€¼ä¸å½“ä¼šé€ æˆåˆ†ç¾¤æ•ˆæœä¸å¥½ï¼Œåæ–‡å°†ä¼šä»‹ç»ä¸¤ç§æ–¹æ³•ç”¨æ¥è¯„ä¼°<strong>K</strong>å€¼åŠåˆ†ç¾¤æ•ˆæœã€‚å¹¶ä¸”æœ¬æ–‡é‡‡ç”¨ä¸¤ç§æ–¹å¼å®ç°<strong>K-means</strong></p>
<ul>
<li>
<p>ä½¿ç”¨<strong>scikit-learn</strong>æ¨¡å—è¿›è¡Œ<strong>K-means</strong>èšç±»åˆ†æã€‚</p>
</li>
<li>
<p>ä»å¤´æ‰‹å†™<strong>K-means</strong>æ–¹æ³•ã€‚</p>
</li>
</ul>
<h3 id="12-ç®—æ³•åŸç†">1.2 ç®—æ³•åŸç†</h3>
<ol>
<li>éšæœºåœ¨æ ·æœ¬ä¸­é€‰å–<strong>K</strong>è´¨å¿ƒä½œä¸ºèµ·å§‹èšç±»çš„ä¸­å¿ƒã€‚</li>
<li>å°†æ¯ä¸ªæ ·æœ¬æ ¹æ®æ¬§å¼è·ç¦»åˆ†åˆ°æœ€è¿‘çš„è´¨å¿ƒ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Î¼</span></span></span></span>æ‰€åœ¨çš„ç¾¤ä¸­ã€‚</li>
<li>å°†æ‰€æœ‰æ ·æœ¬åˆ†ç¾¤åï¼Œé‡æ–°è®¡ç®—ä»¥æ¯ä¸ªç¾¤çš„ä¸­å¿ƒä½œä¸ºæ–°çš„è´¨å¿ƒã€‚</li>
<li>é‡å¤2ï¼Œ3 ä¸¤æ­¥ï¼ŒçŸ¥é“è´¨å¿ƒä¸å†æ”¹å˜ï¼Œæˆ–è€…è¾¾åˆ°ç”¨æˆ·è‡ªå®šä¹‰çš„é˜ˆå€¼æˆ–æœ€å¤§è¿­ä»£æ•°ã€‚</li>
</ol>
<p><strong>æ¬§å¼è·ç¦»</strong>çš„è®¡ç®—æ–¹æ³•ä¸ºï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><msup><mo>)</mo><mn>2</mn></msup><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>âˆ’</mo><msub><mi>y</mi><mi>j</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mo>=</mo><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo>âˆ’</mo><mi>y</mi><mi mathvariant="normal">âˆ£</mi><msubsup><mi mathvariant="normal">âˆ£</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">d(x,y)^2 = \sum^{m}_{j = 1}(x_j  - y_j )^2 =  ||x - y||^{2}_{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">âˆ£</span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>ä»£è¡¨æ•°æ®çš„çº¬åº¦ã€‚</p>
<p>åŸºäºæ¬§å¼è·ç¦»æˆ‘ä»¬å¯ä»¥æŠŠåˆ†ç¾¤çš„è¿‡ç¨‹æè¿°ä¸ºä¸€ä¸ªä¼˜åŒ–çš„é—®é¢˜ï¼Œæ˜¯ä¸€ç§æœ€å°åŒ–<strong>ç¾¤å†…è¯¯å·®å¹³æ–¹å’Œï¼ˆSSEï¼‰<strong>çš„è¿­ä»£æ–¹æ³•ä¹Ÿè¢«ç§°ä¸º</strong>ç¾¤æƒ¯æ€§</strong>ã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>S</mi><mi>E</mi><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msup><mi>w</mi><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow></msup><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><msup><mi>x</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>âˆ’</mo><msup><mi>Î¼</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mi mathvariant="normal">âˆ£</mi><msubsup><mi mathvariant="normal">âˆ£</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">SSE = \sum^{n}_{i =1 } \sum^{k}_{j=1 } w^{(i,j)}||x^{(i)} - \mu^{(i)}||^{2}_{2} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2498900000000006em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä»£è¡¨æ ·æœ¬ç´¢å¼• <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>ä»£è¡¨åˆ†ç¾¤ç´¢å¼•</p>
<h2 id="2ä½¿ç”¨scikit-learnå®ç°k-meansæ–¹æ³•">2.ä½¿ç”¨<strong>scikit-learn</strong>å®ç°<strong>K-means</strong>æ–¹æ³•</h2>
<hr>
<h3 id="21-åˆ›å»ºæµ‹è¯•æ•°æ®å¹¶å®ç°ç®—æ³•">2.1 åˆ›å»ºæµ‹è¯•æ•°æ®å¹¶å®ç°ç®—æ³•</h3>
<p>é¦–å…ˆå¯¼å…¥æ‰€éœ€è¦çš„æ¨¡å—ï¼š</p>
<pre><code class="language-python"># import module
import numpy as np
from matplotlib import cm
from sklearn.datasets import make_blobs
from sklearn.cluster import KMeans
import matplotlib.pyplot as plt
from sklearn.metrics import silhouette_samples
</code></pre>
<p>å› ä¸ºäºŒç»´æ•°æ®å¯æ˜¯ç®€å•çš„ç»˜åˆ¶åœ¨ç¬›å¡å°”åæ ‡ç³»ä¸Šï¼Œæ‰€ä»¥ç”ŸæˆäºŒç»´æµ‹è¯•æ•°æ®è¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="language-python"># creat tested data
X, y = make_blobs(n_samples=150, # volume of data 
                  n_features=2, # number of feature 
                  centers=3, # number of centroid
                  cluster_std=0.5,  # distribution of data 
                  shuffle=True,
                  random_state=0)
</code></pre>
<p>ç»˜å›¾æŸ¥çœ‹åŸå§‹æ•°æ®ï¼š</p>
<pre><code class="language-python"># plot tested data
plt.figure()
plt.scatter(X[:, 0], X[:, 1], c='white', marker='o', edgecolor='black', s=50)
plt.grid()
plt.show()
</code></pre>
<img src="file:///Users/liyang/Documents/Gridea/post-images/1572156791933.png" width="400" hegiht="200" align=center />
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºåˆ›å»ºçš„æµ‹è¯•æ•°æ®æœ‰æ˜æ˜¾çš„åˆ†ç¾¤æƒ…å†µ,å½“ç„¶åœ¨çœŸå®çš„æ•°æ®å½“ä¸­åŸå§‹æ•°æ®å¯èƒ½æ²¡æœ‰è¿™ä¹ˆç†æƒ³ã€‚æˆ‘ä»¬å…ˆåœ¨æ²¡æœ‰æ¨ç†çš„æƒ…å†µä¸‹ç¡®å®š<strong>K</strong>çš„å€¼ä¸º3ã€‚</p>
<pre><code class="language-python"># k-means
km = KMeans(n_clusters=3, # K value 
            init='random',
            n_init=10, # number of repeatation 
            max_iter=300, 
            tol=1e-4, 
            random_state=0)
# predict labels
y_km = km.fit_predict(X)
</code></pre>
<p>æˆ‘ä»¬è¿›è¡Œå¯è§†åŒ–åˆ†ç¾¤ç»“æœï¼š</p>
<pre><code class="language-python">#creating function of ploting graph for reusing 
def plot_res(y_km, X, n_cluster):
    # init colors and markers
    colors = ['lightgreen', 'orange', 'lightblue'][:n_cluster]
    markers = ['s', 'o', 'v'][:n_cluster]

    # plot the cluster to comfirm the result of k-meams by sklearn
    for i, (c, m) in enumerate(zip(colors, markers)):
        plt.scatter(X[y_km == i, 0],
                    X[y_km == i, 1],
                    s=50,
                    c=c,
                    marker=m,
                    edgecolor='black',
                    label=f'cluster {i}')

    # plot centroipd of  different clusters
    plt.scatter(km.cluster_centers_[:, 0],
                km.cluster_centers_[:, 1],
                s=250,
                marker='*',
                c='red',
                edgecolors='black',
                label='centroids')
    # plot lengend
    plt.legend(scatterpoints=1)
    # plot grid
    plt.grid()
    plt.show()

</code></pre>
<img src="file:///Users/liyang/Documents/Gridea/post-images/1572158215803.png" width="400" hegiht="200" align=center />
<p>å¯ä»¥æ˜æ˜¾çœ‹åˆ°åˆ†ç¾¤æ•ˆæœååˆ†æ˜æ˜¾ã€‚ä¸è¿‡å…¶ä¸­è¿˜æœ‰è®¸å¤šé—®é¢˜ï¼š</p>
<ol>
<li>å¦‚ä½•ç¡®å®<strong>K</strong>å€¼</li>
<li>å¦‚ä½•è¯„ä¼°åˆ†ç¾¤è´¨é‡</li>
</ol>
<h3 id="22-å¦‚ä½•é€‰å–kå€¼">2.2 å¦‚ä½•é€‰å–<strong>K</strong>å€¼</h3>
<p>ä¸‹é¢ä»‹ç»å¦‚ä½•ä½¿ç”¨è‚˜è§£æ³•é€‰å–åˆé€‚çš„<strong>K</strong>å€¼ï¼Œè‚˜è§£æ³•ç›®çš„æ˜¯æ‰¾å‡ºSSEå˜åŒ–å¹…åº¦æœ€å¤§çš„<strong>K</strong>å€¼ã€‚ä½¿ç”¨<code>km.inertia_</code> å³å¯è°ƒå‡º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">SSE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>çš„å€¼ã€‚</p>
<pre><code class="language-python">
distortions = []
# test different  numbers of cluster  to  pick up the best K
for i in range(1, 11):
    km = KMeans(n_clusters=i,
                init='k-means++',
                n_init=10,
                max_iter=300,
                random_state=0)

    km.fit(X)
    distortions.append(km.inertia_)

</code></pre>
<p>æµ‹è¯•1-11çš„<strong>K</strong>å€¼é€‰å–ï¼Œå¹¶è¿›è¡Œå¯è§†åŒ–æŸ¥çœ‹ç»“æœã€‚</p>
<pre><code class="language-python"># plot the tested result for the best K

plt.plot(range(1, 11), distortions, marker='o')
plt.xlabel('Number of clusters')
plt.ylabel('Distortion')
plt.show()
</code></pre>
<img src="file:///Users/liyang/Documents/Gridea/post-images/1572160740933.png" width="400" hegiht="200" align=center />
<p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºåœ¨<strong>K</strong>å€¼ä¸º3çš„æ—¶å€™ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">SSE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>å˜åŒ–å¹…åº¦æœ€å¤§ï¼Œå³å¯å¾—çŸ¥<strong>K</strong>ä¸º3æ˜¯æœ€ä¼˜è§£ã€‚</p>
<h3 id="23-å¦‚ä½•è¯„ä¼°åˆ†ç¾¤çš„è´¨é‡">2.3 å¦‚ä½•è¯„ä¼°åˆ†ç¾¤çš„è´¨é‡</h3>
<p>è¯„ä»·èšç±»è´¨é‡çš„ä¸€ç§æ–¹æ³•æ˜¯<strong>è½®å»“åˆ†æ</strong>ï¼Œä»–å¯ä»¥åº”ç”¨äºå…¶ä»–èšç±»ç®—æ³•ï¼Œåº¦é‡å…¶ç´§å¯†ç¨‹åº¦ã€‚è®¡ç®—è½®å»“ç³»æ•°çš„æ­¥éª¤ä¸ºï¼š</p>
<ol>
<li>è®¡ç®—é›†ç¾¤å†…èšåº¦<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">a^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå³æ ·æœ¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>äºé›†ç¾¤å†…æ‰€æœ‰å…¶ä»–ç‚¹ä¹‹é—´çš„å¹³å‡è·ç¦»ã€‚</li>
<li>è®¡ç®—é›†ç¾¤ä¸æœ€è¿‘é›†ç¾¤çš„åˆ†ç¦»åº¦<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>b</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">b^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>,å³æ ·æœ¬<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>ä¸æœ€è¿‘é›†ç¾¤å†…æ‰€æœ‰æ ·æœ¬çš„å¹³å‡è·ç¦»ã€‚</li>
<li>è®¡ç®—è½®å»“ç³»æ•°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>s</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">s^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå³é›†ç¾¤å†…èšåº¦ä¸é›†ç¾¤åˆ†ç¦»åº¦ä¹‹å·®ï¼Œé™¤ä»¥ä¸¤è€…ä¸­è¾ƒå¤§çš„ä¸€ä¸ªã€‚</li>
</ol>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>s</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>=</mo><mfrac><mrow><msup><mi>b</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>âˆ’</mo><msup><mi>a</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><mrow><mi>max</mi><mo>â¡</mo><mo>{</mo><mrow><msup><mi>b</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>a</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><mo>}</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">s^{(i)} = \frac{b^{(i)} - a^{(i)}}{\max \{{b^{(i)},a^{(i)}}\}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.519em;vertical-align:-0.954em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.565em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mopen">{</span><span class="mord"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>è½®å»“ç³»æ•°çš„èŒƒå›´åœ¨-1åˆ°1ä¹‹é—´ï¼Œå¦‚æœé›†ç¾¤åˆ†ç¦»åº¦å’Œé›†ç¾¤å†…èšåº¦ç›¸ç­‰ï¼Œå³<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>b</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">b^{(i)}=a^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚é‚£ä¹ˆè½®å»“ç³»æ•°ä¸º0ï¼Œå¦‚æœ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>b</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>&gt;</mo><mo>&gt;</mo><msup><mi>a</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">b^{(i)} &gt;&gt; a^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9270999999999999em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> åˆ™æ¥è¿‘ç†æƒ³çš„è½®å»“ç³»æ•° 1 ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨<strong>scikit-learn</strong>ä¸­<strong>metric</strong>ä¸­çš„<strong>silhouette_samples</strong>è®¡ç®—æ ·æœ¬çš„è½®å»“ç³»æ•°ã€‚ä¹Ÿå¯ä»¥æ›´æ–¹ä¾¿çš„ä½¿ç”¨<strong>silhouette_scores</strong>ç›´æ¥è®¡ç®—æ‰€æœ‰æ ·æœ¬çš„å¹³å‡è½®å»“ç³»æ•°ã€‚ä¸‹é¢æ˜¾ç¤º<strong>K</strong>å€¼åŸºäº3çš„åˆ†ç¾¤ç»“æœã€‚</p>
<pre><code class="language-python"># we can use the graph of silhouette to evaluate  result
km = KMeans(n_clusters=3,
            init='k-means++',
            n_init=10,
            max_iter=10,
            tol=1e-04,
            random_state=0)
y_km = km.fit_predict(X)
</code></pre>
<p>ç»˜åˆ¶è½®å»“å›¾è¿›è¡Œå¯è§†åŒ–ï¼Œç›´è§‚çš„æŸ¥çœ‹ç¾¤å†…è½®å»“ç³»æ•°ã€‚</p>
<pre><code class="language-python"># difining fuction of plot-silhouette for reusing
# plot the graph of silhouette
def plot_sil(y_km, X):
    cluster_lables = np.unique(y_km)
    n_clusters = cluster_lables.shape[0]

    # using function of silhouette in sklearn to get silhouete scores
    silhouette_vals = silhouette_samples(X, y_km, metric='euclidean')

    # plot the graph
    y_ax_lower, y_ax_upper = 0, 0
    yticks = []
    for i, c in enumerate(cluster_lables):
        # get values of  each cluster
        c_silhouette_vals = silhouette_vals[y_km == c] 
        c_silhouette_vals.sort()  # sort value for ploting
        y_ax_upper += len(c_silhouette_vals)
        color = cm.jet(float(i) / n_clusters)
        plt.barh(range(y_ax_lower, y_ax_upper),
                 c_silhouette_vals,
                 height=1.0,
                 edgecolor='none',
                 color=color)
        yticks.append((y_ax_lower + y_ax_upper) / 2)
        y_ax_lower += len(c_silhouette_vals)

    silhouette_avg = np.mean(silhouette_vals)  # get the label of yticks
    plt.axvline(silhouette_avg, color='red',
                linestyle='--')  # plot the avaerage of silhouette
    plt.yticks(yticks, labels=cluster_lables)
    plt.ylabel('Cluster')
    plt.xlabel('Silhouette coefficient')
    plt.show()

</code></pre>
<img src="file:///Users/liyang/Documents/Gridea/post-images/1572162327225.png" width="400" hegiht="200" align=center />
<p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè½®å»“ç³»æ•°ä¸æ¥è¿‘äº0ï¼Œä¸”æ¥è¿‘äº1è¡¨æ˜æˆ‘ä»¬çš„åˆ†ç¾¤ç»“æœè‰¯å¥½ã€‚ä¸”åœ¨å›¾ä¸­è½®å»“ç³»æ•°çš„é«˜åº¦ä»£è¡¨ç¾¤å†…æ ·æœ¬æ•°é‡ï¼Œå¦‚æœæ ·æœ¬æ•°é‡ç›¸å·®å¤ªå¤§ï¼Œè¯´æ˜åˆ†ç¾¤æ•ˆæœä¸æ˜¯å¾ˆå¥½ã€‚å›¾ä¸­è™šçº¿è¡¨ç¤ºå¹³å‡è½®å»“ç³»æ•°ã€‚</p>
<p>ä¸ºæ›´å¥½çš„ç†è§£è½®å»“ç³»æ•°çš„ä½¿ç”¨ï¼Œå°†<strong>K</strong>å€¼å˜ä¸º2ï¼Œè¿›è¡Œèšç±»ã€‚</p>
<pre><code class="language-python">km = KMeans(
    n_clusters=2,  # value of k has changed 
    init='k-means++',
    n_init=10,
    max_iter=10,
    tol=1e-04,
    random_state=0)
y_km = km.fit_predict(X)
</code></pre>
<p>ä½¿ç”¨ä¸Šæ–¹ä½œå›¾å‡½æ•°ï¼Œå…ˆè§‚å¯Ÿåˆ†ç¾¤æ•ˆæœã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://cauliyang.github.io/post-images/1572162593247.png" alt=""></figure>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºåˆ†ç¾¤æ•ˆæœå¾ˆå·®ï¼Œå¯è§†åŒ–è½®å»“ç³»æ•°æŸ¥çœ‹ç»“æœã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://cauliyang.github.io/post-images/1572162888640.png" alt=""></figure>
<p>ä¸¤ä¸ªç¾¤çš„é«˜åº¦ä¸ä¸€è‡´è¡¨æ˜åˆ†ç¾¤æ•ˆæœä¸æ˜¯å¾ˆç†æƒ³ï¼Œä¸”æœ‰çš„æ ·æœ¬è½®å»“ç³»æ•°æä½æ¥è¿‘äº0ã€‚è¡¨ç¤ºåˆ†ç¾¤æœ‰å¾ˆå¤§çš„é—®é¢˜ï¼Œéœ€è¦é‡æ–°æ€è€ƒ<strong>K</strong>å€¼çš„é€‰å–ã€‚</p>
<h2 id="3-k-means-from-scratch">3. K-means from scratch</h2>
<p>æˆ‘ä»¬æ ¹æ®ç®—æ³•åŸç†ä½¿ç”¨<strong>Python</strong>ä¸€æ­¥æ­¥å®ç°<strong>K-means</strong>ï¼Œé¦–å…ˆå±•ç¤ºæˆ‘ä»¬æ‰€ç”¨åˆ°çš„æ•°æ®é›†ï¼Œæœ‰å…³åŸºå› åœ¨ä¸åŒæ¡ä»¶ä¸‹å¤„ç†çš„è¡¨è¾¾æ•°æ®ï¼Œå…¶ä¸­åŸºå› æ•°é‡ä¸ºæ ·æœ¬æ•°é‡ï¼Œå¤„ç†æ–¹å¼ä¸ºçº¬åº¦ã€‚å¹¶ä¸”è®¾è®¡ä¸º<strong>Terminal</strong>ç«¯ä½¿ç”¨ã€‚</p>
<p>ç»ˆç«¯ä½¿ç”¨æ–¹æ³•ä¸ºï¼š</p>
<p><code>Usage : python k_mean.py k data max_it (cetroids)</code></p>
<p>å…¶ä¸­</p>
<ul>
<li>k_mean.py ä¸ºç¨‹åºè„šæœ¬</li>
<li>k ä¸ºåˆ†ç¾¤æ•°é‡</li>
<li>data ä¸ºåŸå§‹æ•°æ®æ–‡ä»¶</li>
<li>max_it ä¸ºæœ€å¤§é€’å½’æ¬¡æ•°</li>
<li>centroids ä¸ºåˆå§‹çš„è´¨å¿ƒï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©æä¾›æˆ–è€…ä¸æä¾›</li>
</ul>
<p>åŸå§‹æ•°æ®ï¼š</p>
<table>
<thead>
<tr>
<th>gene_expression</th>
<th>treat_1</th>
<th>treat_2</th>
<th>...</th>
</tr>
</thead>
<tbody>
<tr>
<td>g_1</td>
<td>0.2</td>
<td>0.5</td>
<td>...</td>
</tr>
<tr>
<td>g_2</td>
<td>1.4</td>
<td>1.6</td>
<td>...</td>
</tr>
<tr>
<td>...</td>
<td>4.2</td>
<td>2.1</td>
<td>...</td>
</tr>
</tbody>
</table>
<h3 id="31-get-parameters-from-terminal">3.1 Get parameters from terminal</h3>
<p>å¯¼å…¥æ‰€éœ€çš„æ¨¡å—</p>
<pre><code class="language-python"># import modules
import sys
import time
import numpy as np
from collections import Counter
from operator import itemgetter
</code></pre>
<p>ä»ç»ˆç«¯è·å–ç”¨æˆ·ä¼ é€’å‚æ•°ï¼š</p>
<pre><code class="language-python"># defining function for getting parameters from terminal
def get_argv():
    '''
    get the parameters entered by user and return the dictionary parameters
    '''
    # get parameters
    argv_list = sys.argv
    # init parameters
    argv_name = (
        'data',
        'init_cetroids',
        'gene_num',  # numbers of row 
        'ndim',
        'max_it',  # max numbers of  iter
        'k')
    #  determine whether user provide init-centroids according numbers of parameters
    if len(argv_list) == 4:
        # if not provide init-centroid
        _, k, file, max_it = argv_list
        # get information of file
        argv_tuple = get_Cetroid(file, int(k)) + (int(max_it), int(k))
    elif len(argv_list) == 5:
        # if provide init-centroid
        _, k, file, max_it, cetroid_file = argv_list
        # get information
        argv_tuple = get_Cetroid(
            file, int(k), cetroid_file=cetroid_file) + (int(max_it), int(k))
    elif len(argv_list) &lt; 4:
        #  if numbers of parameters is less than  need parameters  then print help
        print('''
            -------------------------------------------------
            Requirement : numpy 

            Usage : python k_mean.py k data max_it (cetroids)

            Result_file : kmeans.out

            Contact : &lt;liyangyang&gt; &lt;yangyangli.vince@gmail.com&gt;

            -------------------------------------------------

            ''')
        sys.exit(0)
    # return dictionary parameters
    return dict(zip(argv_name, argv_tuple))

</code></pre>
<h3 id="32-creating-function-of-report">3.2 Creating function of report</h3>
<pre><code class="language-python"># difining  function of reporting summary 
def summary(kw, tim, kmeanout='kmeans.out'):
    '''
    Create a summary function, count recursive times, run time, etc.ã€‚
    '''

    # statistics for each Cluster data
    def print_cluster(kmean=kmeanout):
        # evaluate data
        counter = Counter(np.loadtxt(kmean, dtype=int)[:, 1])
        # produce report
        for clu, num in counter.most_common():
            print(f'    Cluster_{clu} : {num}')

    # creat statistic header
    print('{:-^40}\n'.format('Summary'))
    # print statstic report of each cluster
    print_cluster()
    # print overall information
    print(f'''
    Max_iter_number : {kw['max_it']} 
    Cluster_number  :{kw['k']} 
    Time  : {tim:.2f}s 
    Date  : {time.asctime()}''')
    # creat statistic tial
    print('{:-&lt;40}\n'.format('-'))
</code></pre>
<h3 id="33-calculating-euclidean-distance">3.3 Calculating Euclidean distance</h3>
<pre><code class="language-python"># defining function to calculate Euclidean distance
def eucl_Distance(init_cetroids, piece_data):
    ''' 
    Calculate the Euclidean distance between each data and the centroid
    '''
    distance = np.sqrt(np.sum((init_cetroids - piece_data)**2, axis=1))
    # return euclidean distance
    return distance

</code></pre>
<h3 id="34-getting-centroid-information-and-recursive-function">3.4 Getting centroid information and recursive function</h3>
<pre><code class="language-python">def get_Cetroid(file, k, cetroid_file=None):
    ''' 
    This function is used to get raw data file information: raw data, centroid, data volume, feature dimension
    '''
    # get content of  file
    data = np.loadtxt(file)
    # get information: data volume, feature dimension
    gene_num, ndim = data.shape
    # Determine whether the user provides a centroid, and  randomly if not provided
    if not (cetroid_file):
        # init centroid
        init_cetroids = np.zeros((k, ndim))
        # provied centroid randomly
        for i in range(k):
            index = int(np.random.uniform(0, gene_num))
            init_cetroids[i, :] = data[index, :]
    else:
        # if users provide centroid
        init_cetroids = np.loadtxt(cetroid_file)
    # return information
    return (data, init_cetroids, gene_num, ndim)


    def iter_Cetroid(**argv):
    '''
    Iterative clustering results
    '''
    # get neccessary parameters
    data, init_cetroids, gene_num, ndim, max_it, k = argv.values()
    # init results
    Result = np.zeros((gene_num, 2), dtype=int)
    # grouping data according to Euclidean distance
    for i in range(gene_num):
        # get Euclidean distance
        distance = eucl_Distance(init_cetroids, data[i, :])
        # get the label of shortest distance
        cluster = distance.argmin()
        # grouping
        Result[i, :] = np.array([i, cluster])
    # verify that the results of the iteration are stable and return a new centroid
    Handle, argv['init_cetroids'] = assert_Result(data, init_cetroids, Result,
                                                  k)
    # return informattion
    return Result, Handle.all(), argv, max_it

</code></pre>
<h3 id="35-creating-body-function-and-main-function">3.5 Creating Body function and Main function</h3>
<pre><code class="language-python">def run(arg_dict, it_num=0):
    '''
     the body of  k-means 
    '''
    # perform an iteration and verify that the results are stable
    # then  calculate the new centroid to be returned in dictionary form
    Result, handle, arg_dict, max_it = iter_Cetroid(**arg_dict)
    # determine whether the  condition of end iteration is reached
    if not (handle) and (it_num &lt; max_it):
        # if not reach and the iteration continues
        it_num += 1
        # print numbers of iteration
        print(f'...ing Iter Number :{it_num}')
        # recursive iteration
        run(arg_dict, it_num=it_num)
    # if reach condition
    else:
        # change lable,like change the lables from  0,1,2 to 1,2,3
        Result = Result + 1
        count_1 = Counter(Result[:, 1])
        # save result file
        np.savetxt('kmeans.out', Result, fmt='%d')

def main():
    '''
    the program main function, integrate workflow, and generate reports
    '''
    # get start time
    TIC = time.time()
    # get parameter through terminal
    ARGV = get_argv()
    # running the body function  of k-means
    run(ARGV)
    # get end time
    TOC = time.time()
    # generate report
    summary(ARGV, TOC - TIC)
</code></pre>
<h2 id="4-summary">4. Summary</h2>
<p>æœ¬ç¯‡æ–‡ç« è¯¦ç»†è®°å½•ä¸¤ç§æ–¹å¼å®ç°<strong>K-means</strong>æ–¹æ³•ï¼Œå¹¶ä¸”è®°å½•å¦‚ä½•é€‰å–<strong>K</strong>å€¼ï¼Œå¦‚ä½•è¯„ä¼°èšç±»è´¨é‡ã€‚æœ¬æ–‡æœ€ç»ˆæ¶‰åŠçš„ä»£ç éƒ½ä¼šåœ¨<a href="https://github.com/cauliyang/Python_book_practice/blob/master/effective_python_practice.ipynb"><strong>Jupyter notebook</strong></a>æ‰¾åˆ°,å¹¶ä¸”ä½¿ç”¨<a href="https://github.com/cauliyang/work/tree/master/001_k_mean">è„šæœ¬ç¨‹åº</a></p>
<p>è°¢è°¢è§‚çœ‹ï¼Œæ¬¢è¿äº¤æµï¼ğŸ˜</p>
]]></content>
    </entry>
</feed>